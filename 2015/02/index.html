<!DOCTYPE html>

<html class="no-js" lang="en-US">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="http://gmpg.org/xfn/11" rel="profile"/>
<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>February 2015 – BoochTek, LLC</title>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="../../feed" rel="alternate" title="BoochTek, LLC » Feed" type="application/rss+xml">
<link href="../../comments/feed" rel="alternate" title="BoochTek, LLC » Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/blog.boochtek.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&amp;subset=latin%2Clatin-ext" id="twentysixteen-fonts-css" media="all" rel="stylesheet" type="text/css"/>
<link href="../../wp-content/themes/twentysixteen/genericons/genericons.css?ver=3.4.1" id="genericons-css" media="all" rel="stylesheet" type="text/css"/>
<link href="../../wp-content/themes/twentysixteen/style.css?ver=4.7.2" id="twentysixteen-style-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='http://blog.boochtek.com/wp-content/themes/twentysixteen/css/ie.css?ver=20150825' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='http://blog.boochtek.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20150825' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='http://blog.boochtek.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20150825' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://blog.boochtek.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<script src="../../wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="../../wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<link href="../../wp-json/" rel="https://api.w.org/"/>
<link href="../../xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="../../wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<meta content="WordPress 4.7.2" name="generator"/>
</link></head>
<body class="archive date hfeed">
<div class="site" id="page">
<div class="site-inner">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header class="site-header" id="masthead" role="banner">
<div class="site-header-main">
<div class="site-branding">
<p class="site-title"><a href="../" rel="home">BoochTek, LLC</a></p>
<p class="site-description">Web Development, Ruby on Rails, Open Source</p>
</div><!-- .site-branding -->
</div><!-- .site-header-main -->
</header><!-- .site-header -->
<div class="site-content" id="content">
<div class="content-area" id="primary">
<main class="site-main" id="main" role="main">
<header class="page-header">
<h1 class="page-title">Month: February 2015</h1> </header><!-- .page-header -->
<article class="post-202 post type-post status-publish format-standard hentry category-oop category-ruby category-rails" id="post-202">
<header class="entry-header">
<h2 class="entry-title"><a href="../2015/02/23/hexagonal-rails-controllers" rel="bookmark">Hexagonal Rails Controllers</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>I’ve had a long love-hate relationship with Rails. I love the MVC framework and how it’s improved our speed of writing web apps. But I’ve never really been completely happy with it. I don’t generally agree with most of its opinions. I prefer models that follow the Data Mapper pattern, not the Active Record pattern. This includes separating the persistence layer from the models’ business logic. I prefer Slim or HAML to ERB. I prefer RSpec to Test::Unit or MiniTest. When Merb hit the scene, I was ready to make the jump, until Merb merged with Rails.</p>
<p>So inspired by <a href="https://blog.engineyard.com/2015/life-beyond-rails-brief-look-alternate-web-frameworks-ruby">PJ Hagerty’s recent article on alternative Ruby web frameworks</a>, I started thinking about how I’d write a replacement for Rails. I’d definitely keep the basic MVC framework. But I’d also want to implement a more <a href="http://alistair.cockburn.us/Hexagonal+architecture">hexagonal architecture</a>.</p>
<p>I started sketching out what this would look like, but I ended up starting with a Rails controller and finding the simplest way to make it hexagonal. I really don’t like callbacks, because they make tracing program execution difficult. But I didn’t see any other alternative. I found a simple pub/sub Ruby library called Wisper. It literally has only <code>publish</code>, <code>subscribe</code>, and <code>on</code> methods. (You use <code>on</code> to register single callbacks via blocks, and <code>subscribe</code> to register an object with method names corresponding to the callback names.)</p>
<p>The trick was figuring out how to break the controller into 2 pieces. What finally helped me was to find the single responsibilities of the 2 pieces. The Rails controller would remain in charge of managing the web interface, but would delegate to the other piece to handle any application-specific business logic. I decided to re-watch <a href="http://confreaks.tv/videos/rubymidwest2011-keynote-architecture-the-lost-years">Uncle Bob Martin’s “Architecture The Lost Years” talk</a>, which was the first time I was introduced to the ideas of Hexagonal Architecture. (He doesn’t name the architecture in the talk, but later calls it Clean Architecture.) He does a decent job of explaining how to break these 2 pieces apart. He used the term “interactor” in that talk, so I decided to go with that. He said that Jacobsen calls it a Control Object in <a href="http://www.amazon.com/Object-Oriented-Software-Engineering-Approach/dp/0201544350">Object Oriented Software Engineering</a>, but that’s too close to Rails’s “controller”.</p>
<p>So here’s an example of what I ended up with:</p>
<pre>class OrderController &lt; ApplicationController
  def index
    interactor.on(:display) { |orders| render orders }
    interactor.list
  end

  def show
    interactor.on(:display) { |order| render order }
    interactor.on(:not_found) { |order_id| render status: 404 }
    interactor.get(params[:id])
  end

private

  def interactor
    @interactor ||= OrderInteractor.new
  end
end</pre>
<pre>require "wisper"
require "order"

class OrderInteractor
  include Wisper.publisher

  def list
    orders = Order.all
    publish(:display, orders)
  end

  def get(id)
    order = Order.find(id)
    publish(:display, order)
  rescue ActiveRecord::RecordNotFound
    publish(:not_found, id)
  end
end</pre>
<p>I do have a few problems with this solution though. I’m not a fan of the name “interactor” for the business logic. I thought about calling it <code>OrderOperator</code>, or maybe <code>OrderOperations</code>, because it’s really a collection of operations. Perhaps it would be better to separate each operation into a separate class. <a href="https://github.com/apotonick/trailblazer">Trailblazer</a> does it that way. And for more complicated business logic, I would do that too, using the Method Object pattern. But like a Rails controller, there’s a lot in common among all the operations. I feel like a separate class for each operation for each would create too many coupled classes.</p>
<p>I’m also uncomfortable with the fact that the controller is delegating almost everything to the interactor. I guess this is OK, but it feels like there’s too little left when every line starts with <code>interactor</code>. I suppose extracting things some more would help mitigate this concern I’ll likely write a small gem to perform that extraction. I expect that that will allow a typical controller to be written in only a few lines. And maybe the same for the interactor side.</p>
<p>With the business logic extracted out of the controller, it was really easy for me to write a command-line version of the app. As Uncle Bob says, “the web is not particularly important to your application.”</p>
<p>I’ve put the code for this example on GitHub: <a href="https://github.com/boochtek/hexagonal-rails">https://github.com/boochtek/hexagonal-rails</a>. I’ll likely experiment with it some more over the next few weeks and months.</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2015/02/23/hexagonal-rails-controllers" rel="bookmark"><time class="entry-date published updated" datetime="2015-02-23T23:50:28+00:00">February 23, 2015</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming/oop" rel="category tag">OOP</a>, <a href="../category/programming/programming-languages/ruby" rel="category tag">Ruby</a>, <a href="../category/webdev/rails" rel="category tag">Ruby on Rails</a></span><span class="comments-link"><a href="../2015/02/23/hexagonal-rails-controllers#respond">Leave a comment<span class="screen-reader-text"> on Hexagonal Rails Controllers</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
<article class="post-198 post type-post status-publish format-standard hentry category-agile category-blogging category-brilliant category-resolutions category-security" id="post-198">
<header class="entry-header">
<h2 class="entry-title"><a href="../2015/02/02/resolutions" rel="bookmark">Resolutions</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>January kept me pretty busy, so I’m a little late to this. But better late than never. And as an Agile practitioner, I don’t think personal retrospectives should be limited to one time of year.</p>
<h1>Review of 2014</h1>
<p>Last year I wrote a blog entry listing <a href="../2014/01/04/open-source-resolutions">my goals for 2014</a>. As far as New Year’s resolutions go, I was relatively successful — about 50% of my goals accomplished. Unfortunately, my Open Source contributions weren’t as strong as I had hoped; while I released some of my own work, I didn’t do much else. I did increase my blogging; getting in on a weekly blogging pact helped immensely. I also increased my participation on the <a href="http://thisagilelife.com/">This Agile Life podcast</a> to a level that I’m happy with. But the accomplishment I’m most proud of was giving a <a href="https://www.youtube.com/watch?v=hc_wtllfKtQ">presentation at RubyConf</a>.</p>
<h1>Plans for 2015</h1>
<p>I’d like to keep things rolling from last year, but crank up a few things. My plans are quite ambitious, so I don’t expect to get everything done by any means. But I think by setting the bar high, I’ll end up with a lot I can be proud of.</p>
<h2>Job Hunting</h2>
<p>Late last year, I took the jump into independent consulting. So far, I’ve really enjoyed it, and I’m booked up through April. My wife graduates in May, so we’ve got the possibility of moving if that makes sense. So I’ll be looking for consulting projects in town, but I’ll also be looking at jobs in San Francisco and Chicago. The possibilities are exciting, and I’ll be taking my time to find something just right.</p>
<h2>Conferences</h2>
<p>I was incredibly nervous leading up to my RubyConf presentation. Part of that was just the common fear of public speaking. For me, that only kicks in at around 100 people, and this audience was around 250. I think another reason was that I chose a really ambitious topic, and I kept finding more that I wanted to talk about, but wasn’t prepared for. But I think I did a pretty good job presenting an advanced topic. And I was so pumped by the sense of accomplishment as soon as I finished. So I’m hoping to do it more. I’ve already submitted a couple proposals, and plan to submit several more.</p>
<h2>Blogging</h2>
<p>I believe that blogging is important for me to get my thoughts down — for myself and to share with others. I was really successful last year when I had a partner to keep me honest, via a pact. So I’ve started up <a href="https://github.com/booch/pact">another pact</a> this year, which will hopefully ensure I’ll keep things going. I’ve got a really long backlog of topics, so as long as I keep at it, I’ll have plenty to write about.</p>
<p>I also want to move away from WordPress to a static system — probably <a href="https://middlemanapp.com/">Middleman</a>. I’ve got 2 major problems with WordPress. First, I no longer trust its security, nor the security of any application written in PHP. Second, it generates HTML every time someone requests a page, instead of when the content is updated. I find that to be a waste of resources, and problematic from a security standpoint. The main problem with moving to a static blogging system is that I really want to allow comments, pingbacks, and tweetbacks. So I’ll have to find a way to integrate those.</p>
<h2>Programming Language Design</h2>
<p>Last year I started thinking about programming language design, and started implementing a language tentatively called <a href="../2014/03/30/brilliant-my-own-programming-language">Brilliant</a>. I’ve done a lot more thinking on the topic, and have a lot of notes. But I haven’t implemented much more yet. This year, I’d like to get my thoughts more organized, and write a series of blog posts on various aspects of language design. The most interesting part seems to be the trade-offs involved in the ways that various language features interact. So I’d like to make some progress on the language implementation, but more importantly, I’d like to get a lot of my design ideas written down.</p>
<p>I’m also going to spend a lot of time learning a bunch more programming languages, so I have a better understanding of possible features, combinations of features, and their interactions. I’ve already start with Elixir, Clojure, and Racket. I’m hoping to also look at OCaml, Factor, and Haskell. I’ll probably also take a look at the 2 “Seven Languages in Seven Weeks” books.</p>
<h2>Agile Book</h2>
<p>I think people often have trouble getting started with Agile. I started on a book last year, and got down quite a lot of good ideas. But I realized that I’m going to have a hard time organizing all those ideas into something coherent. Still, I’d like to try to get something out there that lets people get started with Agile. My idea is to present a toolbox of practices to get started with and build on that foundation over time with additional practices. Sort of a playbook on how to get started over the first 6 to 12 months and be successful. I want to make some progress on the book, at least enough to decide whether it’s worth the effort to finish it and self-publish it.</p>
<p> </p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2015/02/02/resolutions" rel="bookmark"><time class="entry-date published" datetime="2015-02-02T23:42:13+00:00">February 2, 2015</time><time class="updated" datetime="2015-12-28T21:12:28+00:00">December 28, 2015</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/agile" rel="category tag">Agile</a>, <a href="../category/blogging" rel="category tag">Blogging</a>, <a href="../category/programming/programming-languages/brilliant" rel="category tag">Brilliant</a>, <a href="../category/resolutions" rel="category tag">Resolutions</a>, <a href="../category/security" rel="category tag">Security</a></span><span class="comments-link"><a href="../2015/02/02/resolutions#respond">Leave a comment<span class="screen-reader-text"> on Resolutions</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
</main><!-- .site-main -->
</div><!-- .content-area -->
<aside class="sidebar widget-area" id="secondary" role="complementary">
<section class="widget widget_pages" id="pages-2"><h2 class="widget-title">Pages</h2> <ul>
<li class="page_item page-item-2"><a href="../about">About</a></li>
</ul>
</section><section class="widget widget_categories" id="categories-4"><h2 class="widget-title">Categories</h2> <ul>
<li class="cat-item cat-item-17"><a href="../category/agile">Agile</a>
</li>
<li class="cat-item cat-item-26"><a href="../category/programming/architecture">Architecture</a>
</li>
<li class="cat-item cat-item-20"><a href="../category/blogging">Blogging</a>
</li>
<li class="cat-item cat-item-25"><a href="../category/programming/programming-languages/brilliant">Brilliant</a>
</li>
<li class="cat-item cat-item-30"><a href="../category/agile/empathy">Empathy</a>
</li>
<li class="cat-item cat-item-27"><a href="../category/agile/estimation-agile">Estimation</a>
</li>
<li class="cat-item cat-item-22"><a href="../category/gadgets">Gadgets</a>
</li>
<li class="cat-item cat-item-7"><a href="../category/open-source/linux">GNU/Linux</a>
</li>
<li class="cat-item cat-item-9"><a href="../category/programming/programming-languages">Languages</a>
</li>
<li class="cat-item cat-item-19"><a href="../category/programming/oop">OOP</a>
</li>
<li class="cat-item cat-item-5"><a href="../category/open-source">Open Source</a>
</li>
<li class="cat-item cat-item-8"><a href="../category/programming">Programming</a>
</li>
<li class="cat-item cat-item-16"><a href="../category/programming/programming-languages/python">Python</a>
</li>
<li class="cat-item cat-item-29"><a href="../category/resolutions">Resolutions</a>
</li>
<li class="cat-item cat-item-28"><a href="../category/agile/retrospectives">Retrospectives</a>
</li>
<li class="cat-item cat-item-10"><a href="../category/programming/programming-languages/ruby">Ruby</a>
</li>
<li class="cat-item cat-item-6"><a href="../category/webdev/rails">Ruby on Rails</a>
</li>
<li class="cat-item cat-item-12"><a href="../category/security">Security</a>
</li>
<li class="cat-item cat-item-21"><a href="../category/programming/programming-languages/shell">Shell</a>
</li>
<li class="cat-item cat-item-13"><a href="../category/sysadmin">System Admin</a>
</li>
<li class="cat-item cat-item-18"><a href="../category/agile/tdd">TDD</a>
</li>
<li class="cat-item cat-item-4"><a href="../category/webdev">Web Development</a>
</li>
</ul>
</section> </aside><!-- .sidebar .widget-area -->
</div><!-- .site-content -->
<footer class="site-footer" id="colophon" role="contentinfo">
<div class="site-info">
<span class="site-title"><a href="../" rel="home">BoochTek, LLC</a></span>
<a href="https://wordpress.org/">Proudly powered by WordPress</a>
</div><!-- .site-info -->
</footer><!-- .site-footer -->
</div><!-- .site-inner -->
</div><!-- .site -->
<script src="../../wp-content/themes/twentysixteen/js/skip-link-focus-fix.js?ver=20150825" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script src="../../wp-content/themes/twentysixteen/js/functions.js?ver=20150825" type="text/javascript"></script>
<script src="../../wp-includes/js/wp-embed.min.js?ver=4.7.2" type="text/javascript"></script>
</body>
</html>
