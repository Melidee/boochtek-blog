<!DOCTYPE html>

<html class="no-js" lang="en-US">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="http://gmpg.org/xfn/11" rel="profile"/>
<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>March 2014 – BoochTek, LLC</title>
<link href="//fonts.googleapis.com" rel="dns-prefetch"/>
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="../../feed" rel="alternate" title="BoochTek, LLC » Feed" type="application/rss+xml">
<link href="../../comments/feed" rel="alternate" title="BoochTek, LLC » Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/blog.boochtek.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&amp;subset=latin%2Clatin-ext" id="twentysixteen-fonts-css" media="all" rel="stylesheet" type="text/css"/>
<link href="../../wp-content/themes/twentysixteen/genericons/genericons.css?ver=3.4.1" id="genericons-css" media="all" rel="stylesheet" type="text/css"/>
<link href="../../wp-content/themes/twentysixteen/style.css?ver=4.7.2" id="twentysixteen-style-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='http://blog.boochtek.com/wp-content/themes/twentysixteen/css/ie.css?ver=20150825' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='http://blog.boochtek.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20150825' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='http://blog.boochtek.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20150825' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://blog.boochtek.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<script src="../../wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="../../wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<link href="../../wp-json/" rel="https://api.w.org/"/>
<link href="../../xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="../../wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<meta content="WordPress 4.7.2" name="generator"/>
</link></head>
<body class="archive date hfeed">
<div class="site" id="page">
<div class="site-inner">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header class="site-header" id="masthead" role="banner">
<div class="site-header-main">
<div class="site-branding">
<p class="site-title"><a href="../" rel="home">BoochTek, LLC</a></p>
<p class="site-description">Web Development, Ruby on Rails, Open Source</p>
</div><!-- .site-branding -->
</div><!-- .site-header-main -->
</header><!-- .site-header -->
<div class="site-content" id="content">
<div class="content-area" id="primary">
<main class="site-main" id="main" role="main">
<header class="page-header">
<h1 class="page-title">Month: March 2014</h1> </header><!-- .page-header -->
<article class="post-172 post type-post status-publish format-standard hentry category-brilliant category-programming-languages" id="post-172">
<header class="entry-header">
<h2 class="entry-title"><a href="../2014/03/30/brilliant-my-own-programming-language" rel="bookmark">Brilliant – My Very Own Programming Language</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>I’ve decided to design and implement my own programming language, and call it <a href="https://github.com/BoochTek/brilliant">Brilliant</a>.</p>
<p>I’ve been interested in programming languages and linguistics almost as long as I’ve been using computers. I’ve long thought that if I ever go back to college, it’s likely that I’ll concentrate on programming languages as a specialty.</p>
<p>My recent discovery and involvement with the <a href="http://crystal-lang.org/">Crystal</a> programming language has gotten me excited about new language ideas. It’s also helped me realize that implementing a language myself is feasible, and that there’s no better time to start than now.</p>
<h1>Implementation</h1>
<p>For now, the Brilliant implementation doesn’t let you do much more than “Hello World”. But you gotta start somewhere. So this article isn’t really “Introducing Brilliant” so much as the start of a series of articles on its design and implementation.</p>
<p>I wanted to use a PEG (parsing expression grammar) parser for several reasons. For one, they seem to have gained a lot of popularity in the past few years. Also, PEGs cannot be ambiguous, which can solve a few difficult problems, such as the “dangling <code>else</code>“. Perhaps my favorite feature of PEG grammars is that you don’t need a separate tokenizer (lexer). This provides a nice advantage in that we can use keywords like “<code>class</code>” as variables, as long as they’re not used in a place where the keyword would make sense.</p>
<p>So knowing that I wanted to use a PEG, I had to find a PEG parser. I kind of wanted to use <a href="http://www.antlr.org/">ANTLR</a>, which has been a leading parser for many years. But the PEG seems to be new to version 4, and I couldn’t find any Ruby bindings for version 4. <a href="http://treetop.rubyforge.org/">Treetop</a> seems to be the most popular parser for Ruby, but I found the EBNF format that <a href="https://github.com/jarhart/rattler">Rattler</a> uses to be more to my taste. I think the fact that it’s newer also gives it a few advantages, having had a chance to learn some lessons from Treetop.</p>
<p>I thought about using the Rubinius VM, but decided to go with <a href="http://llvm.org/">LLVM</a>, mainly since it has slightly better docs for Ruby, and because it’s what Crystal uses. Also, it’s pretty easy to get it to compile to a binary executable or run in a JIT. In the future, I might consider switching to the Rubinius VM, the Erlang VM, or the Perl 6 VM (<a href="http://www.parrot.org/">Parrot</a>). But for now, I like the idea of being able to compile to a binary and easily interface with C, just like Crystal.</p>
<h1>Goals</h1>
<p>My main goal is to have fun playing around with language ideas.</p>
<p>I’ve found a really great language in Ruby, so I’ll be using it as a starting point. But Ruby does have its faults. In some ways, I want to answer the question “what would Ruby look like if we designed it today?”.</p>
<p>But I also want to explore other ideas. What if objects defaulted to immutable? What if functions and methods were assumed to be pure by default? Might it be possible to infer the purity of a function or method? (If so, we could automatically memoize them.) Can we make creating an actor as easy as creating an object?</p>
<p>I’ll also be looking at ideas from other programming languages. Could we get some of the benefits of Haskell’s purity without having to do somersaults to do IO? Could we mix Python’s indentation style scoping with brace style or <code>begin</code>/<code>end</code> style? Could we integrate Icon’s ideas about success and failure (goal-directed execution)? What interesting features can we pull from Ada, Io, CoffeeScript, Crystal, Rubinius, Perl 6, etc.?<i><br/>
</i></p>
<p>I’m not so much as interested in cutting-edge features, as in features that can be easily used by the average programmer. More importantly, I’m interested in how features interact with each other, so they fit well together to create a whole that’s greater than the sum of the parts.</p>
<h1>Naming</h1>
<p>I wanted to name my programming language “Fermat”. I’ve long been intrigued by <a href="http://en.wikipedia.org/wiki/Fermat's_Last_Theorem">Fermat’s Last Theorem</a>, and <a href="http://en.wikipedia.org/wiki/Fermat%27s_little_theorem">Fermat’s Little Theorem</a> is important in number theory. Unfortunately, there’s already a computer algebra system with that name.</p>
<p>So I decided to find a name in the same vein as “Ruby” and “Crystal”. I looked at the Wikipedia page for “gemstones” for some inspiration. A lot of the names of gemstones are already taken. I considered some obscure gemstones, but saw the word “brilliant” and thought it was decent. It’s not the name of another gemstone, but still evokes some similarity to Ruby and Crystal.</p>
<p>So that’s the name for now. Perhaps I’ll decide to change it at some point in the future, but I needed a name for the project, as well as a file extension for source code files. I chose “<code>bril</code>” for that. I suppose “<code>br</code>” would be a better choice. Perhaps I’ll change that before the next article in this series.</p>
<h1>Future</h1>
<p>I hope to work on Brilliant every once in a while. I expect it’ll take a couple years before it’s really very useful.</p>
<p>When I do add a major feature, I’ll be certain to blog about it. I’ve got tons of ideas strewn about in various files. It would be great to get them organized and published —and even better to get them implemented.</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2014/03/30/brilliant-my-own-programming-language" rel="bookmark"><time class="entry-date published updated" datetime="2014-03-30T23:25:38+00:00">March 30, 2014</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming/programming-languages/brilliant" rel="category tag">Brilliant</a>, <a href="../category/programming/programming-languages" rel="category tag">Languages</a></span><span class="comments-link"><a href="../2014/03/30/brilliant-my-own-programming-language#comments">1 Comment<span class="screen-reader-text"> on Brilliant – My Very Own Programming Language</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
<article class="post-161 post type-post status-publish format-standard hentry category-agile category-estimation-agile tag-estimation tag-no-estimates" id="post-161">
<header class="entry-header">
<h2 class="entry-title"><a href="../2014/03/23/agile-estimation" rel="bookmark">Estimation Isn’t Agile</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>I don’t believe that estimation should be part of any Agile practice.</p>
<p>One of our managers recently mentioned that we hadn’t met the “contract” that we had “committed” to in our last iteration. This was complete nonsense, because A) we hadn’t made any such commitments, and B) we completed many more story points than the previous iterations (and without inflating story points).</p>
<p><a href="../wp-content/uploads/2014/03/estimates-as-deadlines.png"><img alt="estimates-as-deadlines" class="alignnone size-full wp-image-162" height="361" src="http://blog.boochtek.com/wp-content/uploads/2014/03/estimates-as-deadlines.png" width="500"/></a></p>
<p>But her language made me come to several realizations. First and foremost, estimates are contracts. Sure, they’re not <strong>supposed</strong> to be treated as commitments, but they almost always are. And what does the <a href="http://agilemanifesto.org/">Agile Manifesto</a> say about this? It says that we should value customer collaboration over contract negotiation, and responding to change over following a plan. So it’s pretty clear that treating estimates as commitments is completely counter to the Agile values.</p>
<p>Why does this matter? What benefits do the Agile values bring us? I think the biggest benefit they bring is changing the way that we work, so that we can better deliver value to our customers. Without Agile, we’d just keep working the way we’ve always done things. And that didn’t seem to be working out so well. If we follow the Agile values and principles, at least we’ll have a fighting chance of improving our ability to deliver value.</p>
<p>Ask yourself — have you ever seen a software development project that was on time and on budget? Where the estimates were spot-on? Of course not. For one, we’re terrible at estimating. For another, our plans change — either from external factors, or from what we learn as we go.</p>
<h1>Improved Estimation</h1>
<p>To me, Agile is also about facing reality — and embracing it. It realizes that we’re terrible at estimating. It realizes that plans change. Most Agile methodologies have some tricks to counteract <b><a href="http://en.wikipedia.org/wiki/Hofstadter's_law">Hofstadter’s law</a></b>. Generally, we use relative story points instead of hours, and then use an empirical factor to convert points to hours.</p>
<p>When this works, it is better than any other estimation I’ve ever seen. But it doesn’t work very often. People have trouble with relative estimation. How do you set the basis for what a point means without relating it to actual hours? Affinity estimation could work, but then you have to remember what the basis was. We’ve got a large distributed team, and when we tried this, we couldn’t all remember what the basis was.</p>
<p>Since we couldn’t get affinity estimation to work, we tried changing to perfect hours (only powers of 2). But then people thought of them as time. When we took longer than the estimate on an individual story, managers and team members thought we were taking longer than we should have. So our estimates ended up causing problems.</p>
<h1>What Can We Do Instead?</h1>
<p>Managers want estimates so that they can have predictability. They want to know when new features will be available. Is there a better way to get what we need?</p>
<p>I believe there’s a better way — prioritization. If you work on the most important thing first, then the most important thing will get done first. We should <strong>always</strong> be working on the next most important thing.</p>
<p>What if there’s more than 1 thing that’s most important? Then you’ve failed. You’ve failed at logic if you can’t understand that only 1 thing can be most important. You’ve failed at prioritizing the customers’ needs. You’ve failed at project management.</p>
<h1>Arguments</h1>
<p>1. Why can’t you just tell us how long it will really take?</p>
<p>Because we don’t know. Because we <strong>can’t</strong> know. This is the first time we’ve ever implemented the functionality you’ve asked for. If we’d done it before, we’d just use that existing code. As Glenn Vanderburg pointed out in his excellent talk on <a href="http://www.infoq.com/presentations/Software-Engineering">Software Engineering</a>, we’re not building software, we’re architecting it.</p>
<p>2. But we have to tell our customers what to expect.</p>
<p>Why? Is the product so bad that you can’t keep customers around without leading them on with future enhancements? And why do customers need exact dates? A general roadmap telling them what the priorities for upcoming features should be sufficient.</p>
<p>3. But we have to have messaging about new features.</p>
<p>OK. Then send out that messaging once the feature has made it to Staging. Or even after it’s been rolled out to Production.</p>
<p>4. But we’ve promised these new features to the customers by this date.</p>
<p>Ah, so you’ve made promises to the customer that you don’t have control over. Have you ever heard of “under-promise and over-deliver”? That’s how you create happy customers. Yet you’ve done just the opposite, haven’t you? And then you want to blame someone else.</p>
<p><span style="color: #000000; font-weight: bold;">Risk</span></p>
<p>Estimates are risk. But the risk doesn’t come at the end, when the estimates are shown to be incorrect. The risk was in asking for the estimates in the first place, and placing trust in them. Don’t do it. Don’t promise things that you can’t be sure of.</p>
<p>Embrace this reality. Embrace this uncertainty. Always focus on what’s most important. That’s how you make customers happy.</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2014/03/23/agile-estimation" rel="bookmark"><time class="entry-date published" datetime="2014-03-23T23:02:28+00:00">March 23, 2014</time><time class="updated" datetime="2015-11-30T21:16:30+00:00">November 30, 2015</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/agile" rel="category tag">Agile</a>, <a href="../category/agile/estimation-agile" rel="category tag">Estimation</a></span><span class="tags-links"><span class="screen-reader-text">Tags </span><a href="../tag/estimation" rel="tag">estimation</a>, <a href="../tag/no-estimates" rel="tag">no estimates</a></span><span class="comments-link"><a href="../2014/03/23/agile-estimation#comments">3 Comments<span class="screen-reader-text"> on Estimation Isn’t Agile</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
<article class="post-154 post type-post status-publish format-standard hentry category-agile category-programming" id="post-154">
<header class="entry-header">
<h2 class="entry-title"><a href="../2014/03/16/slow-down" rel="bookmark">Slow Down!</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>There’s a tweet that I saw recently, with some simple advice for novice programmers:</p>
<blockquote><p>Slow down.</p></blockquote>
<p>This is probably good advice for most programmers. Our team recently noticed that every time we try to rush things, we make mistakes. And the mistakes end up costing us more time than if we had just done things at our normal pace. Slowing down ensures that you do things right, and when you do things right, you end up with a higher-quality product.</p>
<h1>Speed and Code Quality</h1>
<p>There are 2 types of code quality: internal and external. External code quality can be measured by how many bugs have been reported by customers. Internal code quality is harder to measure, but it mainly deals with the ability to change the code. When your internal quality is low, you’ve got lots of technical debt, and it’s harder to make changes.</p>
<p>So when you try to write code quickly, code quality decreases, leading to a code base that takes more time to make changes to. Conversely, when you slow down, your code quality improves, and it becomes easier to make changes more quickly. So when writing code, slowing down in the short run leads to a speed-up in the long run.</p>
<h1>Speed and Process Improvement</h1>
<p>But writing code isn’t the only place where we try to speed up. On an Agile team, we’re always trying to improve the way we work — especially at the beginning stages of an Agile transformation. So we’re eager to make changes in our processes. But I’d urge you to slow down here as well.</p>
<p>My colleague <a href="http://dirtyinformation.com/">Amos</a> and I frequently argue over pair switching. It’s funny, because we agree on everything except for 1 small detail. We both think pair switching is very important, to ensure that team members see more of what’s going on, to bring more ideas to each story, to prevent knowledge silos, and to encourage team ownership. Where we disagree is how long an ideal pairing session should last. I think pairs should switch every 2 hours, and he thinks 1 hour is ideal. I’ve seen teams reach the 1 hour pairing sessions successfully. But usually not without some pain and even often failing at the first attempt.</p>
<p>There’s nothing inherently wrong with failing. But if you fail at something, you’re not likely to try again. After all, you should learn from your failures, right?</p>
<p>So if you want your team to do something, you probably don’t want them to fail at it. If they fail, they won’t want to try a second time. That’s just human nature, and learning from failure. While you might think that they failed because they weren’t ready for the change yet, they’ll most likely think that they failed because this particular change won’t work for their situation. And they probably won’t know what to change when trying again, so they won’t try again.</p>
<p>I’ve seen this over and over. Back when Linux was up-and-coming, when a consultant pushed a company into using Linux before they were ready for it, and it didn’t work out, that company was cautious about trying again. So instead of being on the leading edge of using Linux, or even the middle of the pack, they ended up more toward the trailing edge. Had they not been pushed, they would have gotten more benefit in the long run.</p>
<p>So my advice in process improvement is the same as in programming: slow down. Take small steps toward what you think is the ideal. Make a small change, see how it works out, and adjust. As long as you’re still moving in the right direction, I believe you’ll move faster by taking small steps than by trying to make big leaps.</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2014/03/16/slow-down" rel="bookmark"><time class="entry-date published updated" datetime="2014-03-16T23:14:45+00:00">March 16, 2014</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/agile" rel="category tag">Agile</a>, <a href="../category/programming" rel="category tag">Programming</a></span><span class="comments-link"><a href="../2014/03/16/slow-down#respond">Leave a comment<span class="screen-reader-text"> on Slow Down!</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
<article class="post-110 post type-post status-publish format-standard hentry category-linux category-shell category-sysadmin" id="post-110">
<header class="entry-header">
<h2 class="entry-title"><a href="../2014/03/11/readable-shell-scripts" rel="bookmark">Burying the Lede</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>Most of us don’t write very readable shell scripts. There are plenty of things we could do better, but today I want to talk about one in particular — burying the lede.</p>
<p>The term “burying the lede” comes from the field of journalism. Here’s the <a href="http://en.wiktionary.org/wiki/bury_the_lede">Wiktionary definition</a>:</p>
<blockquote><p>To begin a story with details of secondary importance to the reader while postponing more essential points or facts.</p></blockquote>
<p>Like a good news article, code should tell a story. And the story should start with what’s most important. In the case of code, the most important information is the high-level functionality — a succinct summary of what the program does. In other words, write (and organize) the code top-down, as opposed to bottom-up.</p>
<p>Unfortunately, shell script doesn’t make this easy. Due to the way shell scripts are interpreted, you can’t call a function until after you’ve defined it. This leads to most of us structuring our code like this:</p>
<pre>function do_something { ... }
function do_something_else { ... }

do_something
do_something_else</pre>
<p>The problem with this is that the function definitions will likely take quite a few lines, and we won’t see what the top-level functionality is until we reach the end of the script.</p>
<p>I’d like to propose a standard way to structure shell scripts to mitigate this issue. (I’m really only talking about shell scripts that have function definitions within them.) I’m sure I’ve seen a few scripts do this, but it’s not very common at all.</p>
<p>My proposal is simple:</p>
<pre>function main {
  do_something
  do_something_else
}
function do_something { ... }
function do_something_else { ... }

main</pre>
<p>This structure lets us start with the lede. We describe the top-level functionality right away. Only then do we get to the secondary details. The name <code>main</code> makes it pretty clear that it contains the top-level functionality.</p>
<p>I’ve recently started writing my shell code like this, and I’m happy with the results. I’ve also started to use some other programming techniques in my shell scripts to improve readability: better naming, extracting more methods, and moving helper methods into separate files. It feels good to treat shell scripts like real code instead of just some stuff I’ve hacked together.</p>
<p>PS. The WordPress theme I’m currently using (Twenty Eleven) also buries the lede — I can barely even see the title of the blog post on my screen without scrolling. I’m going to have to change that soon.</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2014/03/11/readable-shell-scripts" rel="bookmark"><time class="entry-date published updated" datetime="2014-03-11T23:28:22+00:00">March 11, 2014</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/open-source/linux" rel="category tag">GNU/Linux</a>, <a href="../category/programming/programming-languages/shell" rel="category tag">Shell</a>, <a href="../category/sysadmin" rel="category tag">System Admin</a></span><span class="comments-link"><a href="../2014/03/11/readable-shell-scripts#respond">Leave a comment<span class="screen-reader-text"> on Burying the Lede</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
<article class="post-129 post type-post status-publish format-standard hentry category-shell category-sysadmin" id="post-129">
<header class="entry-header">
<h2 class="entry-title"><a href="../2014/03/03/yak-shaving-cursor-keys" rel="bookmark">Yak Shaving #1: Cursor Keys</a></h2> </header><!-- .entry-header -->
<div class="entry-content">
<p>I recently decided to start using Emacs again. I used it extensively from the early 1990s until the early 2000s. I pretty much stopped using it when I had a sysadmin job with no Emacs on the servers, and no ability to install it. With the rising popularity of tmux and tmate for remote pairing, and my dislike for vim’s modes, I decided to try going back to Emacs in the terminal.</p>
<p>One thing I <strong>really</strong> want in a text editor is good cursor key support. Shifted cursor keys<br/>
should select text, and Control+left and right should move by words. (<a href="https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/AppleHIGuidelines/KeyboardShortcuts/KeyboardShortcuts.html">Apple HIG</a> says to use Option+left and right to move by words; most apps on Mac OS X seem to support both.) Things have worked this way on almost every text editor on every OS I’ve used — Amiga, DOS, Windows, NeXT, Mac, Motif, Gnome, KDE. It’s a part of the <a href="https://en.wikipedia.org/wiki/Common_User_Access">CUA</a> standard that’s been in common usage on everything since the mid-1980s.</p>
<p>Enabling cursor keys in Emacs was pretty easy. I’ve decided to use <a href="https://github.com/bbatsov/prelude#readme">Prelude</a> to make getting started with Emacs easy. Emacs comes with the cursor keys enabled, but Prelude disables them. Undoing Prelude’s change is pretty easy:</p>
<pre>(setq prelude-guru nil)</pre>
<p>Trying to make shifted cursor keys work is where the trouble began. They work in the GUI version of Emacs, but not from the terminal. It turns out that the Mac Terminal doesn’t distinguish between cursor keys and shifted cursor keys in its default configuration. So I had to figure out how to configure key bindings in Terminal.</p>
<p>That’s easy enough — they’re in the preferences. But what should I set them to? This took a lot of research. Terminal emulation and ANSI code sequences are obscure, complex, and inconsistent. I eventually found the info I needed. For starters, Shift+Right, Shift+Left, Shift+Home, and Shift+End are defined in the terminfo. The rest I was able to piece together from various sources around the Internet.</p>
<p>I’m also trying to <a href="https://github.com/boochtek/mac_config">script my Mac configuration</a>. So instead of manually adding all the keybindings in the Terminal preferences pane, I decided to write a script. Mac OS X does a decent job of allowing you to change preferences from the command line. For example, to always show the tab bar:</p>
<pre>defaults write -app Terminal ShowTabBar 1</pre>
<p>Easy enough, except for a couple problems. First, I had to figure out the obscure syntax used in the preferences for key codes. I was able to piece these together with some more Internet research. But the really big problem is that the keyboard bindings are 2 levels deep within a “dictionary” (hash map). And the <code>defaults</code> command doesn’t handle that. There are some obscure utilities that handle nested preferences, but <a href="https://groups.google.com/forum/#!topic/macenterprise/YgJnfqpyKNs">they don’t work well with the preferences caching in Mac OS X 10.9</a> — a problem I ran into while testing.</p>
<p>So now I’m writing a utility in Python that does what the <code>defaults</code> command does, but that will handle nested dictionaries.</p>
<p>There’s a term for this process of having to solve one issue before you can solve another, and the issues get several layers deep. It’s called <em>yak shaving</em>.</p>
<p>Here’s another good example:</p>
<figure class="wp-caption alignnone" id="attachment_143" style="width: 480px"><a href="../wp-content/uploads/2014/03/ibaDjk7AeIcvxv.gif"><img alt="Father from Malcolm in the middle having to fix one thing before fixing another, ad infinitum." class="size-full wp-image-143" height="360" src="http://blog.boochtek.com/wp-content/uploads/2014/03/ibaDjk7AeIcvxv.gif" width="480"/></a><figcaption class="wp-caption-text">Yak shaving – home repairs</figcaption></figure>
<p>I’m sure this will be the first of many posts about me yak shaving.</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=49&amp;d=blank&amp;r=g" srcset="http://2.gravatar.com/avatar/52bfd7cb9ac37808464919f9685ca62f?s=98&amp;d=blank&amp;r=g 2x" width="49"/><span class="screen-reader-text">Author </span> <a class="url fn n" href="../author/booch">Craig Buchek</a></span></span><span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="../2014/03/03/yak-shaving-cursor-keys" rel="bookmark"><time class="entry-date published updated" datetime="2014-03-03T22:02:59+00:00">March 3, 2014</time></a></span><span class="cat-links"><span class="screen-reader-text">Categories </span><a href="../category/programming/programming-languages/shell" rel="category tag">Shell</a>, <a href="../category/sysadmin" rel="category tag">System Admin</a></span><span class="comments-link"><a href="../2014/03/03/yak-shaving-cursor-keys#respond">Leave a comment<span class="screen-reader-text"> on Yak Shaving #1: Cursor Keys</span></a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
</main><!-- .site-main -->
</div><!-- .content-area -->
<aside class="sidebar widget-area" id="secondary" role="complementary">
<section class="widget widget_pages" id="pages-2"><h2 class="widget-title">Pages</h2> <ul>
<li class="page_item page-item-2"><a href="../about">About</a></li>
</ul>
</section><section class="widget widget_categories" id="categories-4"><h2 class="widget-title">Categories</h2> <ul>
<li class="cat-item cat-item-17"><a href="../category/agile">Agile</a>
</li>
<li class="cat-item cat-item-26"><a href="../category/programming/architecture">Architecture</a>
</li>
<li class="cat-item cat-item-20"><a href="../category/blogging">Blogging</a>
</li>
<li class="cat-item cat-item-25"><a href="../category/programming/programming-languages/brilliant">Brilliant</a>
</li>
<li class="cat-item cat-item-30"><a href="../category/agile/empathy">Empathy</a>
</li>
<li class="cat-item cat-item-27"><a href="../category/agile/estimation-agile">Estimation</a>
</li>
<li class="cat-item cat-item-22"><a href="../category/gadgets">Gadgets</a>
</li>
<li class="cat-item cat-item-7"><a href="../category/open-source/linux">GNU/Linux</a>
</li>
<li class="cat-item cat-item-9"><a href="../category/programming/programming-languages">Languages</a>
</li>
<li class="cat-item cat-item-19"><a href="../category/programming/oop">OOP</a>
</li>
<li class="cat-item cat-item-5"><a href="../category/open-source">Open Source</a>
</li>
<li class="cat-item cat-item-8"><a href="../category/programming">Programming</a>
</li>
<li class="cat-item cat-item-16"><a href="../category/programming/programming-languages/python">Python</a>
</li>
<li class="cat-item cat-item-29"><a href="../category/resolutions">Resolutions</a>
</li>
<li class="cat-item cat-item-28"><a href="../category/agile/retrospectives">Retrospectives</a>
</li>
<li class="cat-item cat-item-10"><a href="../category/programming/programming-languages/ruby">Ruby</a>
</li>
<li class="cat-item cat-item-6"><a href="../category/webdev/rails">Ruby on Rails</a>
</li>
<li class="cat-item cat-item-12"><a href="../category/security">Security</a>
</li>
<li class="cat-item cat-item-21"><a href="../category/programming/programming-languages/shell">Shell</a>
</li>
<li class="cat-item cat-item-13"><a href="../category/sysadmin">System Admin</a>
</li>
<li class="cat-item cat-item-18"><a href="../category/agile/tdd">TDD</a>
</li>
<li class="cat-item cat-item-4"><a href="../category/webdev">Web Development</a>
</li>
</ul>
</section> </aside><!-- .sidebar .widget-area -->
</div><!-- .site-content -->
<footer class="site-footer" id="colophon" role="contentinfo">
<div class="site-info">
<span class="site-title"><a href="../" rel="home">BoochTek, LLC</a></span>
<a href="https://wordpress.org/">Proudly powered by WordPress</a>
</div><!-- .site-info -->
</footer><!-- .site-footer -->
</div><!-- .site-inner -->
</div><!-- .site -->
<script src="../../wp-content/themes/twentysixteen/js/skip-link-focus-fix.js?ver=20150825" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script src="../../wp-content/themes/twentysixteen/js/functions.js?ver=20150825" type="text/javascript"></script>
<script src="../../wp-includes/js/wp-embed.min.js?ver=4.7.2" type="text/javascript"></script>
</body>
</html>
